

# bert4rec
- 해당 폴더에 작성된 코드는 유저 상품 구매 데이터를 이용해 다음에 구매할 상품을 예측하는 코드입니다.
- bert4rec 코드는 [링크](https://github.com/SeongBeomLEE/RecsysTutorial)를 참고하였습니다.
- 해당 코드에 사용된 데이터는 `유저 상품 구매 log 데이터(비공개 데이터)`입니다.
## 모델 
- BERT4Rec은 NLP 분야에서 높은 성능을 보인 Bert의 구조를 추천 시스템에 적용한 모델입니다. 
- 장점
    - sequence 정보를 활용하여 상품을 추천합니다. 협업 필터링이나, 콘텐츠 기반 필터링등 다른 추천 기법들은 sequence 정보를 활용하지 못합니다.
    - 모델학습 시 **MLM기법을 이용**하기 때문에다른 추천 기법에 비해 데이터 수가 적더라도 성능이 높게 나옵니다.
- 단점
    - Bert4Rec을 사용하기 위해서는 다른 도메인에서 pre-trained된 모델을 활용할 수 없기 때문에 모델 학습시  오랜시간과 gpu 자원이 필요합니다.
    - 데이터가 편향되어 있거나 잘못된 정보를 포함하고 있으면 모델의 성능이 저하될 수 있습니다.

## 모델의 성능

### 모델 학습 환경 및 실험 방법

- 학습 파라미터
    - sequence 최대 길이 : 21
    - dropout rate : 0.1
    - learning rate : 0.001
    - epochs : 20
    - optimizer : Adam
- 유저 log 데이터를 세션으로 나눈 경우와 그렇지 않은 경우 2가지에 대한 테스트
- 모델 학습 데이터는 train 데이터에서 50,000 랜덤 추출 하여 학습에 활용
    
    → 전체 데이터 활용시 모델 학습 소요시간이 매우 많음
    
- 학습시 모델 평가는 test 데이터셋에서 5,000개를 임의 추출하여 테스트
    
    → 전체 데이터 활용시 모델 학습 소요시간이 매우 많음
    

### 모델 성능 평가 방법 및 모델 성능

- 모델의 output과 전체 아이템에서 임의 추출 한 데이터 100개를 모델의 추천 결과로 활용
- bert4rec 논문에서 모델을 평가할때 모델의 output과 전체 아이템 중 인기있는 상품 100개를 모델의 추천 결과로 활용하여 평가하는데,
    
    제공된 데이터 셋에서는 인기있는 상품이 의미 없기 때문에(데이터 분석 결론 참고) 100개의 아이템 임의 추출하여 활용
    
- 유저를 세션으로 나눈 경우와 그렇지 않은 2가지 경우에 대해 결과 확인
- 평가 지표에 따른 모델 성능
    
    
    |  | 세션을 나눈경우 | 세션을 나누지 않은 경우 |
    | --- | --- | --- |
    | NDCG@10 | 0.5271 | 0.6547 |
    | HIT@10 | 0.7350 | 0.8186 |
    | HIT@1 | 0 | 0 |

